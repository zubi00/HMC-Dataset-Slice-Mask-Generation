import osimport pydicomimport shutildef process_patient_folder(patient_folder):    print(f"Processing patient folder: {patient_folder}")    masks_folder = os.path.join(patient_folder, 'Masks')        for root, _, files in os.walk(masks_folder):        for file in files:            if file.startswith('RS') and file.endswith('.dcm'):                rs_file_path = os.path.join(root, file)                try:                    rs_data = pydicom.dcmread(rs_file_path)                    print(f"Processing RS file: {file}")                                        ref_series_uid = rs_data.ReferencedFrameOfReferenceSequence[0].RTReferencedStudySequence[0].RTReferencedSeriesSequence[0].SeriesInstanceUID                                        for modality in ['CT', 'MR', 'PT']:                        modality_folder = os.path.join(patient_folder, modality)                        if not os.path.exists(modality_folder):                            continue                                                for series_folder in os.listdir(modality_folder):                            series_path = os.path.join(modality_folder, series_folder)                            if os.path.isdir(series_path):                                for image_file in os.listdir(series_path):                                    if image_file.endswith('.dcm') and 'Image' in image_file:                                        image_path = os.path.join(series_path, image_file)                                        image_data = pydicom.dcmread(image_path)                                                                                if image_data.SeriesInstanceUID == ref_series_uid:                                            print(f"Match found! Copying {file} to {series_path}")                                            shutil.copy2(rs_file_path, series_path)                                            break                                else:                                    continue                                break                        else:                            continue                        break                except Exception as e:                    print(f"Error processing {file}: {str(e)}")def process_multiple_patients(main_folder):    for patient_folder in os.listdir(main_folder):        patient_path = os.path.join(main_folder, patient_folder)        if os.path.isdir(patient_path):            process_patient_folder(patient_path)# Usagemain_folder = '/Users/zubairsaeed/Downloads/PhD/H&N/Patients/H&N-Organized'process_multiple_patients(main_folder)